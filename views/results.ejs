<%- include('partials/header.ejs') %>
<%- include('partials/nav.ejs') %>



<div class="mainBox">
    <h1>Recipes Found</h1>

    <% if (recipes.length === 0) { %>
        <p>No recipes found matching your search.</p>
    <% } else { %>
        <p><%= recipes.length %> recipe(s) found</p>
        
        <div class="recipe-list">
            <% for (let recipe of recipes) { %>
                <div class="recipe-card">
                    <% if (recipe.source === 'web') { %>
                        <!-- Web Search Result (Spoonacular) -->
                        <div class="source-badge" style="background: #FF9800; color: white; padding: 5px 10px; display: inline-block; border-radius: 4px; margin-bottom: 10px; font-weight: bold;">
                            ğŸŒ Web Recipe
                        </div>
                        <img src="<%= recipe.img_url %>" alt="<%= recipe.title %>">
                        <h2><%= recipe.title %></h2>
                        <p><strong>ğŸ½ï¸ Cuisine:</strong> <%= recipe.cuisine %></p>
                        <p><strong>ğŸ´ Meal Type:</strong> <%= recipe.meal_type %></p>
                        <p><strong>ğŸ¥— Diet:</strong> <%= recipe.diet %></p>
                        <% if (recipe.price && parseFloat(recipe.price) > 0) { %>
                            <p><strong>ğŸ’² Price per serving:</strong> $<%= parseFloat(recipe.price).toFixed(2) %></p>
                        <% } %>
                        <% if (recipe.cook_time && recipe.cook_time > 0) { %>
                            <p><strong>â±ï¸ Ready in:</strong> <%= recipe.cook_time %> minutes</p>
                        <% } %>
                        <% if (recipe.servings) { %>
                            <p><strong>ğŸ½ï¸ Servings:</strong> <%= recipe.servings %></p>
                        <% } %>
                        <% if (recipe.sourceUrl) { %>
                            <a href="<%= recipe.sourceUrl %>" target="_blank" style="display: inline-block; margin-top: 10px; padding: 10px 15px; background: #4CAF50; color: white; text-decoration: none; border-radius: 4px; font-weight: bold;">
                                View Full Recipe â†’
                            </a>
                        <% } %>
                    <% } else { %>
                        <!-- Community Search Result (Local Database) -->
                        <div class="source-badge" style="background: #4CAF50; color: white; padding: 5px 10px; display: inline-block; border-radius: 4px; margin-bottom: 10px; font-weight: bold;">
                            ğŸ‘¥ Community Recipe
                        </div>
                        <img src="<%= recipe.img_url %>" alt="<%= recipe.title %>">
                        <h2><%= recipe.title %></h2>
                        <p><strong>ğŸ½ï¸ Cuisine:</strong> <%= recipe.cuisine %></p>
                        <p><strong>ğŸ´ Meal Type:</strong> <%= recipe.meal_type %></p>
                        <p><strong>ğŸ¥— Diet:</strong> <%= recipe.diet %></p>
                        <p><strong>ğŸ’² Price:</strong> $<%= recipe.price ? parseFloat(recipe.price).toFixed(2) : '0.00' %></p>
                        <p><strong>â±ï¸ Cook Time:</strong> <%= recipe.cook_time %> minutes</p>
                        
                        <% if (recipe.fat || recipe.carb || recipe.protein) { %>
                            <div class="nutrition">
                                <span>Fat: <%= recipe.fat || 0 %>g</span>
                                <span>Carbs: <%= recipe.carb || 0 %>g</span>
                                <span>Protein: <%= recipe.protein || 0 %>g</span>
                            </div>
                        <% } %>
                        
                        <% if (recipe.ingredients) { %>
                            <p><strong>Ingredients:</strong> <%= recipe.ingredients %></p>
                        <% } %>
                        <% if (recipe.instructions) { %>
                            <p><strong>Instructions:</strong> <%= recipe.instructions %></p>
                        <% } %>
                    <% } %>
                </div>
            <% } %>
        </div>
    <% } %>

    <a href="/" class="btn btn-light back-btn">â† Back to Search</a>


</div>

<%- include('partials/footer.ejs') %>
